<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <title>간단한 지도 표시하기</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<!--    <link rel="stylesheet" href="/resources/demos/style.css">-->
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script src="https://cdn.amcharts.com/lib/4/core.js"></script>
    <script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
    <script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>
    <!-- 아래의 naver 키를 넣으면 됩니다. -->
    <!--datepicker-->
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <!-- Moment Js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
        <!-- Lightpick CSS -->
    <link rel="stylesheet" href="/static/css/Lightpick.css">

    <!-- Lightpick JS -->
    <script src="/static/js/lightpick.js"></script>
</head>
<body>
<div id="map" style="width:100%;height:400px;"></div>
<div id="check"> HELLO</div>
<!--<div id="result"> {{data}}</div>-->
<p>Date: <input type="text" id="startdate" class="form-control form-control-sm"/><input type="text" id="enddate" class="form-control form-control-sm"/></p>
<input type="button" name="range" id="range" value="조회" class="btn btn-success"/>
<div id="xychart_1"></div>
<script>
    var starttime = "";
    var endtime= "";
    var test = new Date(2020, 12, 12, 13, 0)
    console.log(test)
    var picker = new Lightpick({
        field: document.getElementById('startdate'),
        secondField: document.getElementById('enddate'),
        singleDate: false,
        onSelect: function(start, end){
            var str = '';
            str += start ? start.format('Do MMMM YYYY') + ' to ' : '';
            str += end ? end.format('Do MMMM YYYY') : '...';
            document.getElementById('result').innerHTML = str;
            starttime = start.format('YYYY-MM-DD');
            endtime = end.format('YYYY-MM-DD');
            console.log("start: " + starttime);
            console.log("end: " + endtime);
        }
    });
     $("#range").click(function (){
            console.log("start: " + starttime);
            console.log("end: " + endtime);
            if(starttime != '' && endtime != '') {
                if(starttime < endtime) {
                    $.ajax({
                        type : 'POST',
                        url : '/item_request',
                        data : {
                            fromdate:starttime,
                            todate:endtime
                        },
                        dataType : 'text',
                        success : function(result){
                                alert("result = "+ result);
                        },
                        error : function(xtr,status,error){
                                alert(xtr +":"+status+":"+error);
                        }
                     });
                }else {
                    alert("Please Check the Date");
                }
            } else {
                alert("Please Select the Date");
            }
        });
//////////////////////////////////
am4core.ready(function() {

    am4core.useTheme(am4themes_animated);
    // Themes end

    var chart = am4core.create("xychart_1", am4charts.XYChart);
    chart.hiddenState.properties.opacity = 0; // this creates initial fade-in
    //
    // var data = [];
    // var open = 100;
    // var close = 250;
    //
    // for (var i = 1; i < 120; i++) {
    //     open += Math.round((Math.random() < 0.5 ? 1 : -1) * Math.random() * 4);
    //     close = Math.round(open + Math.random() * 5 + i / 5 - (Math.random() < 0.5 ? 1 : -1) * Math.random() * 2);
    //     data.push({ date: new Date(2018, 0, i), open: open, close: close });
    // }

    chart.data = [{{data}}];

    var dateAxis = chart.xAxes.push(new am4charts.DateAxis());

    var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
    valueAxis.tooltip.disabled = true;

    var series = chart.series.push(new am4charts.LineSeries());
    series.dataFields.dateX = "date";
    series.dataFields.openValueY = "open";
    series.dataFields.valueY = "close";
    series.tooltipText = "open: {openValueY.value} close: {valueY.value}";
    series.sequencedInterpolation = true;
    series.fillOpacity = 0.3;
    series.defaultState.transitionDuration = 1000;
    series.tensionX = 0.8;

    var series2 = chart.series.push(new am4charts.LineSeries());
    series2.dataFields.dateX = "date";
    series2.dataFields.valueY = "open";
    series2.sequencedInterpolation = true;
    series2.defaultState.transitionDuration = 1500;
    series2.stroke = chart.colors.getIndex(6);
    series2.tensionX = 0.8;

    chart.cursor = new am4charts.XYCursor();
    chart.cursor.xAxis = dateAxis;
    chart.scrollbarX = new am4core.Scrollbar();

}); // end am4core.ready()
</script>
<script src="/static/js/map.js"></script>

</body>
</html>